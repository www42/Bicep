# Get stdin and stdout of a custom script extension (Azure VM)
#
# https://stackoverflow.com/questions/38152873/how-can-i-get-the-output-of-a-customscriptextenstion-when-using-azure-resource-m
#

$rgName = 'Demo-RG'
$vmName = 'VM1'
$extensionName = 'customScript'
 
$Status = Get-AzVMExtension -Name $extensionName -VMName $vmName -ResourceGroupName $rgName -Status
$Status.SubStatuses[0]   # stdout
$Status.SubStatuses[1]   # stderr

# --------------------------------------------------

Code          : ComponentStatus/StdOut/succeeded
Level         : Info
DisplayStatus : Provisioning succeeded
Message       : 

                Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 4
                Milliseconds      : 893
                Ticks             : 48930129
                TotalDays         : 5.663209375E-05
                TotalHours        : 0.00135917025
                TotalMinutes      : 0.081550215
                TotalSeconds      : 4.8930129
                TotalMilliseconds : 4893.0129
                
                Install-Module -Name ComputerManagementDsc -Force
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 29
                Milliseconds      : 394
                Ticks             : 293948212
                TotalDays         : 0.000340217837962963
                TotalHours        : 0.00816522811111111
                TotalMinutes      : 0.489913686666667
                TotalSeconds      : 29.3948212
                TotalMilliseconds : 29394.8212
                
                Install-Module -Name az -Force
                Days              : 0
                Hours             : 0
                Minutes           : 18
                Seconds           : 5
                Milliseconds      : 796
                Ticks             : 10857964223
                TotalDays         : 0.0125670882210648
                TotalHours        : 0.301610117305556
                TotalMinutes      : 18.0966070383333
                TotalSeconds      : 1085.7964223
                TotalMilliseconds : 1085796.4223
                
                New-Item -ItemType Directory -Path C:\temp -Force
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 0
                Milliseconds      : 13
                Ticks             : 137970
                TotalDays         : 1.596875E-07
                TotalHours        : 3.8325E-06
                TotalMinutes      : 0.00022995
                TotalSeconds      : 0.013797
                TotalMilliseconds : 13.797
                
                Invoke-WebRequest -Uri $source1 -OutFile $destination1
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 0
                Milliseconds      : 432
                Ticks             : 4325703
                TotalDays         : 5.00660069444444E-06
                TotalHours        : 0.000120158416666667
                TotalMinutes      : 0.007209505
                TotalSeconds      : 0.4325703
                TotalMilliseconds : 432.5703
                
                Invoke-WebRequest -Uri $source2 -OutFile $destination2
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 0
                Milliseconds      : 287
                Ticks             : 2877904
                TotalDays         : 3.33090740740741E-06
                TotalHours        : 7.99417777777778E-05
                TotalMinutes      : 0.00479650666666667
                TotalSeconds      : 0.2877904
                TotalMilliseconds : 287.7904
                
                Invoke-WebRequest -Uri $source3 -OutFile $destination3
                Days              : 0
                Hours             : 0
                Minutes           : 2
                Seconds           : 29
                Milliseconds      : 954
                Ticks             : 1499544645
                TotalDays         : 0.00173558407986111
                TotalHours        : 0.0416540179166667
                TotalMinutes      : 2.499241075
                TotalSeconds      : 149.9544645
                TotalMilliseconds : 149954.4645
                
                Invoke-WebRequest -Uri $source4 -OutFile $destination4
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 0
                Milliseconds      : 936
                Ticks             : 9362386
                TotalDays         : 1.08360949074074E-05
                TotalHours        : 0.000260066277777778
                TotalMinutes      : 0.0156039766666667
                TotalSeconds      : 0.9362386
                TotalMilliseconds : 936.2386
                
                Invoke-WebRequest -Uri $source5 -OutFile $destination5
                Days              : 0
                Hours             : 0
                Minutes           : 0
                Seconds           : 3
                Milliseconds      : 478
                Ticks             : 34788134
                TotalDays         : 4.02640439814815E-05
                TotalHours        : 0.000966337055555556
                TotalMinutes      : 0.0579802233333333
                TotalSeconds      : 3.4788134
                TotalMilliseconds : 3478.8134
                         
Time          : 
